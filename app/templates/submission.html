{% extends 'layouts/_survey.html' -%}

{% block page_title -%}Summary{% endblock -%}

{% block survey -%}
  <div class="header">
    <h1 class="header__title h1">Your responses</h1>
    <h2 class="header__subtitle">Please check carefully before submission</h2>
  </div>

<div>

  {%- for group in content.questionnaire.groups -%}

    {%- for block in group.blocks -%}
      <dl class="dl">
      {%- for section in block.sections -%}

        {%- for question in section.questions -%}

          {%- for response in question.responses -%}
            {% if question.type == 'DateRange' %}
              {% if loop.index == 2 %}
                {% set question_title = question.title %}
                {% set response_value %}
                  {{question.responses[loop.index0 - 1].label}}: {{question.responses[loop.index0 - 1].value}}<br>
                  {{response.label}}: {{response.value}}
                {% endset %}
              {% endif %}
            {% elif response.type == 'Currency' %}
              {% set question_title = question.title or response.label %}
              {% set response_value = response.value|int|format_currency if response.value else 'N/A' %}
            {% elif response.type == 'Radio' %}
               {% set question_title = question.title or response.label %}
               {% set response_value = response.value %}
            {% elif response.type == 'Checkbox' %}
              {% set question_title = question.title or response.label %}
              {% set response_value %}
                {% if response.value and response.value|length > 0 %}
                  <ul class="list list--bullets">
                      {% for response in response.value %}
                        {% if response %}
                          <li class="list__item">{{response}}</li>
                        {% endif %}
                      {% endfor %}
                  </ul>
                {% else %}
                  N/A
                {% endif %}
              {% endset %}
            {% else %}
              {% set question_title = question.title or response.label %}
              {% set response_value = response.value if response.value else 'N/A' %}
            {% endif %}

            {% set full_width = 'fw' if response.type == 'Textarea' %}

            {% if question_title and response_value %}
              <dt class="dt {{full_width}} {{loop.index}}"><div>{{question_title|safe}}</div></dt>
              <dd class="dd {{full_width}} {{loop.index}}">{{response_value|safe}}</dd>
            {% endif %}

          {%- endfor -%}

        {% endfor -%}

      {% endfor -%}
      </dl>
    {% endfor -%}

  {% endfor -%}

  <form action="" method="POST" novalidate>
    <button class="btn btn--secondary u-mr-s qa-btn-submit-answers" type="submit" name="action[submit_answers]">Submit answers</button>
    <a class="u-dib" href="first">Change your answers</a>
  </form>
</div>

{% endblock -%}
